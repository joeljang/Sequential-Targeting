Total number of data of old tasks:  200
/root/fortuna/wheel/tasks/utils.py:38: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  input = variable(torch.tensor(batch[0]))
tensor([0.4418, 0.4450, 0.4456, 0.4450, 0.4509, 0.4426, 0.4478, 0.4525, 0.4488,
        0.4457, 0.4460, 0.4465, 0.4436, 0.4561, 0.4505, 0.4503, 0.4490, 0.4471,
        0.4417, 0.4397, 0.4517, 0.4501, 0.4473, 0.4507, 0.4435, 0.4522, 0.4495,
        0.4493, 0.4520, 0.4460, 0.4428, 0.4425, 0.4456, 0.4407, 0.4440, 0.4464,
        0.4449, 0.4413, 0.4424, 0.4482, 0.4466, 0.4483, 0.4430, 0.4414, 0.4467,
        0.4447, 0.4478, 0.4448, 0.4459, 0.4440, 0.4468, 0.4366, 0.4442, 0.4452,
        0.4412, 0.4468, 0.4472, 0.4416, 0.4430, 0.4416, 0.4435, 0.4507, 0.4481,
        0.4476], grad_fn=<SqueezeBackward0>)
tensor([0., 1., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 1., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 1.])
Traceback (most recent call last):
  File "wheel_sb.py", line 304, in <module>
    wheel.train(config['savemodel'])
  File "wheel_sb.py", line 174, in train
    ewc = EWC(self.model, oldtasks)
  File "/root/fortuna/wheel/tasks/utils.py", line 24, in __init__
    self._precision_matrices = self._diag_fisher()
  File "/root/fortuna/wheel/tasks/utils.py", line 42, in _diag_fisher
    loss = F.nll_loss(output, batch[1])
  File "/usr/local/lib/python3.6/dist-packages/torch/nn/functional.py", line 2212, in nll_loss
    raise ValueError('Expected 2 or more dimensions (got {})'.format(dim))
ValueError: Expected 2 or more dimensions (got 1)
